#' check_file_ext
#'
#' Check if the resource file extension matches the field_form value
#'
#' @param results dataframe: object returned by assemble_file_ext
#' @param lovs dataframe: object returned by the get_lovs() function
#'
#' @return dataframe
#' @export
#'

check_file_ext <- function(results,
                           lookup = lookup_ext_to_form){

  populated_format <- results[!is.na(results$field_formats),]

  temp <- merge(populated_format,
                lookup_ext_to_form,
                by.x = "field_formats",
                by.y = "list_value_name",
                all.x = TRUE)

  temp$matching <- mapply(grepl,
                          pattern = temp$allowed_type,
                          x = temp$file_exts)

  not_matching <- temp[which(temp$matching == 0 | is.na(temp$matching)),]

  clean_not_matching <- not_matching[c("resource_nid", "field_formats", "allowed_type", "file_exts")]
  return(clean_not_matching)
}
